Приложение для прямого обмена сообщениями между двумя клиентами через UDP, даже если они находятся за NAT устройствами. Использует технику NAT hole punching для установления соединения.


**Сборка:**
```bash
cd hw_3
mkdir build
cd build
cmake ..
make
```

Готовый файл будет в `build/bin/p2p_app`

## Как использовать
Сначала нужно запустить сервер-посредник 

```bash
cd build
./bin/p2p_app rendezvous --address 0.0.0.0 --port 8080
```

Сервер будет ждать подключений клиентов.

В новом терминале:

```bash
cd build
./bin/p2p_app p2p-client --rendezvous 127.0.0.1 --rendezvous-port 8080
```

Клиент подключится к серверу-посреднику и будет ждать второго клиента.

В третьем терминале:

```bash
cd build
./bin/p2p_app p2p-client --rendezvous 127.0.0.1 --rendezvous-port 8080
```

Как только второй клиент подключится, сервер-посредник сообщит обоим клиентам адреса друг друга, и они установят прямое соединение.

### Обмен сообщениями

После установления соединения вы можете отправлять сообщения:

- Просто введите текст и нажмите Enter - отправится сообщение другому клиенту
- Введите `PING` - проверить соединение
- Введите `QUIT` - завершить соединение


**Для rendezvous сервера:**
- `--address <ip>` - на каком адресе слушать (по умолчанию: 0.0.0.0 - все интерфейсы)
- `--port <port>` - на каком порту слушать (по умолчанию: 8080)
- `--help` - показать справку

**Для P2P клиента:**
- `--rendezvous <ip>` - адрес сервера-посредника (обязательно)
- `--rendezvous-port <port>` - порт сервера-посредника (по умолчанию: 8080)
- `--help` - показать справку

## Тестирование в разных сценариях

### Сценарий 1: Один клиент за NAT

- Один клиент на обычной машине с публичным IP
- Второй клиент за NAT устройством (роутером)
- Клиенты должны успешно соединиться

### Сценарий 2: Оба клиента в одной сети

- Оба клиента за одним NAT устройством в одной локальной сети
- Клиенты могут общаться напрямую по локальной сети
- Это самый простой случай

### Сценарий 3: Каждый за своим NAT

- Первый клиент за первым NAT устройством
- Второй клиент за вторым NAT устройством
- Это самый сложный случай, требует hole punching
- Оба клиента должны начать отправку одновременно

## Структура проекта

```
hw_3/
├── src/
│   ├── common/           - Общие компоненты (логирование, протокол, сокеты)
│   ├── rendezvous/       - Сервер-посредник
│   ├── p2p/              - P2P клиент
│   └── main.cpp          - Точка входа
├── CMakeLists.txt        - Конфигурация сборки
├── quick_test.sh         - Скрипт для быстрого тестирования
└── README.md             - Этот файл
```
